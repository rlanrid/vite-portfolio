var m=Object.defineProperty;var p=(h,e,t)=>e in h?m(h,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):h[e]=t;var n=(h,e,t)=>(p(h,typeof e!="symbol"?e+"":e,t),t);import*as i from"https://cdn.skypack.dev/three@0.124.0";import{OrbitControls as f}from"https://cdn.skypack.dev/three@0.124.0/examples/jsm/controls/OrbitControls";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))a(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const r of o.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&a(r)}).observe(document,{childList:!0,subtree:!0});function t(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(s){if(s.ep)return;s.ep=!0;const o=t(s);fetch(s.href,o)}})();class g{constructor(e={appContainerSelector:"#picture"}){n(this,"init",async()=>{await this.loadTexture(),this.createUniforms(),this.createApp(),new i.FontLoader().load("https://assets.codepen.io/66496/noe-display-medium.json",t=>{this.font=t,this.createItems(),this.addEventListeners(),this.update()})});n(this,"loadTexture",async()=>{this.imageTexture=await new i.TextureLoader().load("https://assets.codepen.io/66496/temple-ranch-hero.jpg")});n(this,"createUniforms",()=>{this.uniforms={imageTexture:{value:this.imageTexture}},this.updateUniforms()});n(this,"updateUniforms",()=>{Object.assign(this.uniforms,{},{iter:{value:this.iter},currentMouse:{value:this.currentMouse}})});n(this,"createApp",()=>{this.renderer=new i.WebGLRenderer({devicePixelRatio:1.5,antialias:!0}),this.renderer.setSize(this.appContainer.offsetWidth,this.appContainer.offsetHeight),this.appContainer.appendChild(this.renderer.domElement),this.camera=new i.PerspectiveCamera(45,this.appContainer.offsetWidth/this.appContainer.offsetHeight,1,1e4),this.camera.position.set(-3,2,this.settings.cameraDistance),this.scene=new i.Scene,this.scene.background=new i.Color(this.settings.bgColor),this.controls=new f(this.camera,this.renderer.domElement),this.controls.enableKeys=!1,this.controls.enableZoom=!1,this.controls.enableDamping=!1;let e=new i.AmbientLight(255,.15);this.scene.add(e);let t=new i.DirectionalLight(4456703,.4);t.position.set(5,3,2),t.target.position.set(0,0,0),this.scene.add(t)});n(this,"createItems",()=>{this.geometry=new i.PlaneBufferGeometry(60,60*.652,16*2,9*2);let a=new i.ShaderMaterial({uniforms:this.uniforms,vertexShader:document.getElementById("vertexShader").textContent,fragmentShader:document.getElementById("fragmentShader").textContent,depthTest:!1,transparent:!0,vertexColors:!0,side:i.DoubleSide});const s="DEVELOPER",o=this.font.generateShapes(s,26),r=new i.ShapeBufferGeometry(o);r.computeBoundingBox();const c=-.5*(r.boundingBox.max.x-r.boundingBox.min.x),l=-.2*(r.boundingBox.max.y-r.boundingBox.min.y);r.translate(c,l,2),this.mesh=new i.Mesh(r,a),this.scene.add(this.mesh);let d=new i.TorusGeometry(20,5,10,50),u=new i.MeshPhongMaterial({color:16711935,specular:255,shininess:40});this.blobMesh=new i.Mesh(d,u),this.scene.add(this.blobMesh),this.updateCamera()});n(this,"addEventListeners",()=>{this.appContainer.addEventListener("mousemove",this.onMouseMove)});n(this,"onMouseMove",e=>{this.targetMeshScale<=this.settings.blobMaxScale&&(this.targetMeshScale+=this.settings.blobInflate);let t=new i.Vector3,a=new i.Vector3;t.set(e.clientX/window.innerWidth*2-1,-(e.clientY/window.innerHeight)*2+1,.5),t.unproject(this.camera),t.sub(this.camera.position).normalize();let s=-this.camera.position.z/t.z;a.copy(this.camera.position).add(t.multiplyScalar(s)),this.targetMouse={x:a.x,y:a.y}});n(this,"updateMouse",()=>{const e=(this.targetMouse.x-this.currentMouse.x)*this.settings.mouseEase,t=(this.targetMouse.y-this.currentMouse.y)*this.settings.mouseEase;this.currentMouse.x+=e,this.currentMouse.y+=t});n(this,"updateItems",()=>{this.blobMesh.position.set(this.currentMouse.x,this.currentMouse.y,0);const e=Math.abs(this.targetMouse.x-this.currentMouse.x)*.002+.01;this.blobMesh.rotation.x+=e,this.blobMesh.rotation.y+=e,this.blobMesh.rotation.z+=e;const t=(this.targetMeshScale-this.blobMesh.scale.x)*this.settings.blobScaleEase;this.blobMesh.scale.set(this.blobMesh.scale.x+t,this.blobMesh.scale.x+t,this.blobMesh.scale.x+t),this.targetMeshScale>this.settings.blobMinScale&&(this.targetMeshScale-=this.settings.blobDeflate)});n(this,"updateCamera",()=>{this.camera.aspect=this.appContainer.offsetWidth/this.appContainer.offsetHeight,this.camera.updateProjectionMatrix(),this.renderer.setSize(this.appContainer.offsetWidth,this.appContainer.offsetHeight);const e=this.camera.position.distanceTo(this.mesh.position),t=this.mesh.geometry.boundingBox.max.x-this.mesh.geometry.boundingBox.min.x,a=this.appContainer.offsetWidth/this.appContainer.offsetHeight,s=2*Math.atan(t/a/(2*e))*(180/Math.PI);this.camera.fov=s*1.2});n(this,"update",()=>{this.iter++,this.updateMouse(),this.updateUniforms(),this.updateCamera(),this.updateItems(),this.renderer.render(this.scene,this.camera),window.requestAnimationFrame(this.update)});this.options=e,this.appContainer=document.querySelector(this.options.appContainerSelector),this.iter=0,this.renderer,this.camera,this.scene,this.controls,this.imageTexture,this.uniforms,this.geometry,this.mesh,this.font,this.targetMeshScale=1,this.currentMouse={x:0,y:0},this.targetMouse={x:0,y:0},this.settings={cameraDistance:100,bgColor:273,mouseEase:.05,blobMinScale:1,blobMaxScale:2,blobScaleEase:.05,blobInflate:.015,blobDeflate:.01},this.init()}}new g;
